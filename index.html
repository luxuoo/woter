<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ESP32S3 物联网监控仪表盘</title>
    <link rel="stylesheet" href="style.css">
    <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.8/dist/chart.umd.min.js"></script>
</head>
<body class="font-inter bg-light text-dark min-h-screen">
    <header class="sticky top-0 z-50 bg-white/80 backdrop-blur-sm shadow-sm">
        <div class="container mx-auto px-4 py-3 flex items-center justify-between">
            <div class="flex items-center space-x-3">
                <div class="bg-gradient-to-br from-primary to-secondary text-white p-2.5 rounded-lg shadow-md">
                    <i class="fa fa-microchip text-xl"></i>
                </div>
                <h1 class="text-xl font-bold text-gray-800 hidden sm:block">物联网监控仪表盘</h1>
            </div>
            <div class="flex items-center space-x-2 text-sm text-gray-500">
                <i class="fa fa-refresh" id="refresh-icon"></i>
                <span id="last-update">最后更新: --:--:--</span>
            </div>
        </div>
    </header>

    <main class="container mx-auto px-4 py-8">
        <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
            <div class="lg:col-span-2 space-y-8">
                <section>
                    <div class="grid grid-cols-1 sm:grid-cols-2 xl:grid-cols-4 gap-6" id="live-cards-container">
                        <div class="bg-white rounded-xl p-6 card-shadow animate-pulse"><div class="h-6 bg-gray-200 rounded w-3/4 mb-4"></div><div class="h-10 bg-gray-200 rounded w-1/2"></div></div>
                        <div class="bg-white rounded-xl p-6 card-shadow animate-pulse"><div class="h-6 bg-gray-200 rounded w-3/4 mb-4"></div><div class="h-10 bg-gray-200 rounded w-1/2"></div></div>
                        <div class="bg-white rounded-xl p-6 card-shadow animate-pulse"><div class="h-6 bg-gray-200 rounded w-3/4 mb-4"></div><div class="h-10 bg-gray-200 rounded w-1/2"></div></div>
                        <div class="bg-white rounded-xl p-6 card-shadow animate-pulse"><div class="h-6 bg-gray-200 rounded w-3/4 mb-4"></div><div class="h-10 bg-gray-200 rounded w-1/2"></div></div>
                    </div>
                </section>

                <section class="bg-white rounded-xl p-6 card-shadow">
                    <div class="flex flex-wrap justify-between items-center mb-4">
                        <h3 class="font-bold text-lg text-gray-800">数据趋势</h3>
                        <div class="flex space-x-2" id="chart-toggles">
                            <button data-dataset="0" class="px-3 py-1 text-xs rounded-md bg-danger text-white transition-opacity">温度</button>
                            <button data-dataset="1" class="px-3 py-1 text-xs rounded-md bg-primary text-white transition-opacity">湿度</button>
                        </div>
                    </div>
                    <div class="h-80 relative">
                         <div class="absolute inset-0 flex items-center justify-center text-gray-400" id="chart-loader">加载图表数据中...</div>
                         <canvas id="main-chart"></canvas>
                    </div>
                </section>
            </div>

            <div class="lg:col-span-1 space-y-8">
                <section class="bg-white rounded-xl p-6 card-shadow">
                    <h3 class="font-bold text-lg text-gray-800 mb-4">设备信息</h3>
                    <div id="device-info-container">
                        <div class="space-y-3 animate-pulse">
                            <div class="h-4 bg-gray-200 rounded w-full"></div>
                            <div class="h-4 bg-gray-200 rounded w-5/6"></div>
                            <div class="h-4 bg-gray-200 rounded w-full"></div>
                        </div>
                    </div>
                </section>

                <section class="bg-white rounded-xl p-6 card-shadow">
                    <h3 class="font-bold text-lg text-gray-800 mb-4">异常记录</h3>
                    <div class="overflow-y-auto max-h-96" id="history-records-container">
                        <table class="w-full text-sm text-left">
                            <thead class="text-xs text-gray-700 uppercase bg-light sticky top-0">
                                <tr>
                                    <th scope="col" class="px-4 py-3">类型</th>
                                    <th scope="col" class="px-4 py-3">详情</th>
                                    <th scope="col" class="px-4 py-3">时间</th>
                                </tr>
                            </thead>
                            <tbody id="history-records-body">
                                <tr><td colspan="3" class="p-4"><div class="h-5 bg-gray-200 rounded animate-pulse"></div></td></tr>
                                <tr><td colspan="3" class="p-4"><div class="h-5 bg-gray-200 rounded animate-pulse"></div></td></tr>
                                <tr><td colspan="3" class="p-4"><div class="h-5 bg-gray-200 rounded animate-pulse"></div></td></tr>
                            </tbody>
                        </table>
                    </div>
                </section>
            </div>
        </div>
    </main>
    
    <script src="script.js"></script>
</body>
</html>
